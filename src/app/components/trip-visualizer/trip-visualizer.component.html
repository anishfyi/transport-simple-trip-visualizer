<div class="visualization-container">
  <!-- Debug info -->
  <div style="display: none;">
    Paths count: {{ paths.length }}
    Nodes count: {{ nodes.length }}
  </div>
  
  <svg [attr.width]="getSvgWidth()" [attr.height]="getSvgHeight()">
    <!-- Paths Layer -->
    <g class="paths-layer">
      <path
        *ngFor="let path of paths; trackBy: trackByPath"
        [attr.d]="getPathD(path.from, path.to)"
        [class]="path.type"
        vector-effect="non-scaling-stroke"
        style="stroke: rgb(74, 74, 244); stroke-width: 1.5px;"
      />
    </g>

    <!-- Path Labels Layer -->
    <g class="labels-layer">
      <text
        *ngFor="let path of paths"
        [attr.x]="getPathLabelPosition(path.from, path.to).x"
        [attr.y]="getPathLabelPosition(path.from, path.to).y"
        [class]="'path-label ' + path.type + '-text'"
        [style.display]="path.showLabel ? 'block' : 'none'"
      >
        {{ path.label }}
      </text>
    </g>

    <!-- Nodes Layer -->
    <g class="nodes-layer">
      <g *ngFor="let node of nodes; trackBy: trackByNode">
        <circle
          [attr.cx]="node.x"
          [attr.cy]="node.y"
          [attr.r]="NODE_RADIUS"
          [class]="'node ' + node.type"
        />
        <text
          [attr.x]="node.x"
          [attr.y]="node.y"
          [class]="'node-label ' + node.type + '-text'"
        >
          {{ node.label }}
        </text>
      </g>
    </g>

    <!-- Arrow marker definition -->
    <defs>
      <marker
        id="arrowhead"
        markerWidth="10"
        markerHeight="7"
        refX="9"
        refY="3.5"
        orient="auto"
      >
        <polygon points="0 0, 10 3.5, 0 7" fill="currentColor" />
      </marker>
    </defs>
  </svg>
</div> 